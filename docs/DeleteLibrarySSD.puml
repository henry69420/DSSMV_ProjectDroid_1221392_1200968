@startuml
title UC5 - Apagar Biblioteca (Delete Library)
autonumber

participant "User" as User
participant "LibraryListActivity" as UI <<Activity>>
participant "RequestsService" as Service <<Java Class>>
participant "NetworkHandler" as Network <<Java Class>>
database "API/Backend (DELETE /library/{id})" as Backend

User -> UI : Clica em "Delete" para Library X
activate UI
UI -> UI : Exibe AlertDialog
User -> UI : Clica em "Yes" (Confirmar)
UI -> Service : deleteLibrary(libraryId, callback)
activate Service
Service -> Service : ExecutorService.execute()

group Requisição Assíncrona (Background Thread)
    Service -> Network : openDeleteHttpConnection(url: "/library/{id}")
    activate Network
    Network -> Backend : HTTP DELETE /library/{id}
    activate Backend
    Backend --> Network : 202 Accepted (ou 200 OK)
    deactivate Backend
    Network --> Service : InputStream (ou null)
    deactivate Network

    alt Success (InputStream not null)
        Service -> UI : Handler.post(onSuccess())
    else Error
        Service -> UI : Handler.post(onError(Exception))
    end
end

deactivate Service

alt Success
    UI -> User : Displays Toast("Library deleted")
    UI -> UI : loadLibraries() (Inicia UC2)
else Error
    UI -> User : Displays Toast("Error deleting library")
end

deactivate UI

@enduml